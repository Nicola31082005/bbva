<!-- Admin Panel Header -->
    <header class="admin-header">
        <div class="admin-header-content">
            <h1><i class="admin-icon">⚙️</i> Panel de Configuración BBVA</h1>
            <p style="margin: 10px 0 0 0; opacity: 0.9; font-size: 0.95rem;">Gestiona los datos bancarios de {{data.users.0.name}}</p>
            <div class="admin-nav">
                <a href="/main-page" class="btn btn-secondary">Volver al Inicio</a>
            </div>
        </div>
    </header>

<main class="admin-main">
    <!-- Dashboard Overview -->
    <section class="dashboard-overview">
        <div class="info-banner" style="background: linear-gradient(135deg, #e3f2fd, #bbdefb); border: 2px solid var(--bbva-blue); border-radius: 12px; padding: 15px; margin-bottom: 25px; text-align: center;">
            <p style="margin: 0; color: var(--bbva-blue); font-weight: 500;">
                💡 Configura los datos bancarios que aparecerán en la aplicación principal
            </p>
        </div>
        <div class="stats-grid">
            <div class="stat-card">
                <h3>1</h3>
                <p>Usuario del Sistema</p>
                <i class="stat-icon">👤</i>
            </div>
            <div class="stat-card">
                <h3>{{data.accounts.length}}</h3>
                <p>Cuentas Configuradas</p>
                <i class="stat-icon">🏦</i>
            </div>
            <div class="stat-card">
                <h3>{{data.cards.length}}</h3>
                <p>Tarjetas Configuradas</p>
                <i class="stat-icon">💳</i>
            </div>
            <div class="stat-card">
                <h3>{{data.transactions.length}}</h3>
                <p>Transacciones Activas</p>
                <i class="stat-icon">📈</i>
            </div>
            <div class="stat-card">
                <h3>{{transfersCount}}</h3>
                <p>Transferencias Totales</p>
                <i class="stat-icon">💸</i>
            </div>
        </div>
    </section>

    <!-- Admin Tabs -->
    <div class="admin-tabs">
        <button class="tab-btn active" data-tab="users">👤 Perfil</button>
        <button class="tab-btn" data-tab="accounts">🏦 Cuentas</button>
        <button class="tab-btn" data-tab="cards">💳 Tarjetas</button>
        <button class="tab-btn" data-tab="transactions">📈 Transacciones</button>
        <button class="tab-btn" data-tab="transfers">💸 Transferencias</button>
    </div>

    <!-- Users Management -->
    <section id="users" class="admin-section active">
        <div class="section-header">
            <h2>Perfil del Usuario</h2>
            <button class="btn btn-primary" onclick="editUser({{data.users.0.id}})">✏️ Editar Perfil</button>
        </div>
        <div class="table-container">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>Email</th>
                        <th>Teléfono</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="users-tbody">
                    {{#each data.users}}
                    <tr>
                        <td>{{this.id}}</td>
                        <td>{{this.name}}</td>
                        <td>{{this.email}}</td>
                        <td>{{this.phone}}</td>
                        <td><span class="status-badge status-{{this.status}}">{{this.status}}</span></td>
                        <td>
                            <button class="btn btn-sm btn-edit" onclick="editUser({{this.id}})">Editar</button>
                            <button class="btn btn-sm btn-delete" onclick="deleteUser({{this.id}})">Eliminar</button>
                        </td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>
        </div>
    </section>

    <!-- Accounts Management -->
    <section id="accounts" class="admin-section">
        <div class="section-header">
            <h2>Gestión de Cuentas</h2>
            <button class="btn btn-primary" onclick="openAccountModal()">+ Agregar Cuenta</button>
        </div>
        <div class="table-container">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Usuario</th>
                        <th>Número de Cuenta</th>
                        <th>Tipo</th>
                        <th>Balance</th>
                        <th>Moneda</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="accounts-tbody">
                    {{#each data.accounts}}
                    <tr>
                        <td>{{this.id}}</td>
                        <td>
                            {{#each ../data.users}}
                                {{#if (eq this.id ../userId)}}{{this.name}}{{/if}}
                            {{/each}}
                        </td>
                        <td>{{this.accountNumber}}</td>
                        <td>{{this.type}}</td>
                        <td>{{this.balance}}</td>
                        <td>{{this.currency}}</td>
                        <td><span class="status-badge status-{{this.status}}">{{this.status}}</span></td>
                        <td>
                            <button class="btn btn-sm btn-edit" onclick="editAccount({{this.id}})">Editar</button>
                            <button class="btn btn-sm btn-delete" onclick="deleteAccount({{this.id}})">Eliminar</button>
                        </td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>
        </div>
    </section>

    <!-- Cards Management -->
    <section id="cards" class="admin-section">
        <div class="section-header">
            <h2>Gestión de Tarjetas</h2>
            <button class="btn btn-primary" onclick="openCardModal()">+ Agregar Tarjeta</button>
        </div>
        <div class="table-container">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Usuario</th>
                        <th>Número de Tarjeta</th>
                        <th>Tipo</th>
                        <th>Límite</th>
                        <th>Moneda</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="cards-tbody">
                    {{#each data.cards}}
                    <tr>
                        <td>{{this.id}}</td>
                        <td>
                            {{#each ../data.users}}
                                {{#if (eq this.id ../userId)}}{{this.name}}{{/if}}
                            {{/each}}
                        </td>
                        <td>{{this.cardNumber}}</td>
                        <td>{{this.type}}</td>
                        <td>{{this.limit}}</td>
                        <td>{{this.currency}}</td>
                        <td><span class="status-badge status-{{this.status}}">{{this.status}}</span></td>
                        <td>
                            <button class="btn btn-sm btn-edit" onclick="editCard({{this.id}})">Editar</button>
                            <button class="btn btn-sm btn-delete" onclick="deleteCard({{this.id}})">Eliminar</button>
                        </td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>
        </div>
    </section>

    <!-- Transactions Management -->
    <section id="transactions" class="admin-section">
        <div class="section-header">
            <h2>Gestión de Transacciones</h2>
            <button class="btn btn-primary" onclick="openTransactionModal()">+ Agregar Transacción</button>
        </div>
        <div class="table-container">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Cuenta</th>
                        <th>Tipo</th>
                        <th>Descripción</th>
                        <th>Monto</th>
                        <th>Moneda</th>
                        <th>Fecha</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="transactions-tbody">
                    {{#each data.transactions}}
                    <tr>
                        <td>{{this.id}}</td>
                        <td>
                            {{#each ../data.accounts}}
                                {{#if (eq this.id ../accountId)}}{{this.accountNumber}}{{/if}}
                            {{/each}}
                        </td>
                        <td><span class="transaction-type transaction-{{this.type}}">{{this.type}}</span></td>
                        <td>{{this.description}}</td>
                        <td class="amount {{#if (gt this.amount 0)}}positive{{else}}negative{{/if}}">{{this.amount}} {{this.currency}}</td>
                        <td>{{this.currency}}</td>
                        <td>{{formatDate this.date}}</td>
                        <td>
                            <button class="btn btn-sm btn-edit" onclick="editTransaction({{this.id}})">Editar</button>
                            <button class="btn btn-sm btn-delete" onclick="deleteTransaction({{this.id}})">Eliminar</button>
                        </td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>
        </div>
    </section>

    <!-- Transfers Management -->
    <section id="transfers" class="admin-section">
        <div class="section-header">
            <h2>Gestión de Transferencias</h2>
            <button class="btn btn-primary" onclick="openTransferModal()">+ Agregar Transferencia</button>
        </div>
        <div class="table-container">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Tipo</th>
                        <th>Cuenta Origen</th>
                        <th>Beneficiario</th>
                        <th>Cuenta Destino</th>
                        <th>Descripción</th>
                        <th>Monto</th>
                        <th>Moneda</th>
                        <th>Estado</th>
                        <th>Fecha</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="transfers-tbody">
                    {{#each data.transfers}}
                    <tr>
                        <td>{{this.id}}</td>
                        <td><span class="transfer-type transfer-{{this.transferType}}">{{this.transferType}}</span></td>
                        <td>
                            {{#each ../data.accounts}}
                                {{#if (eq this.id ../fromAccountId)}}{{this.accountNumber}}{{/if}}
                            {{/each}}
                        </td>
                        <td>{{this.recipientName}}</td>
                        <td>{{this.recipientAccount}}</td>
                        <td>{{this.description}}</td>
                        <td class="amount {{#if (eq this.transferType 'received')}}positive{{else}}negative{{/if}}">{{this.amount}} {{this.currency}}</td>
                        <td>{{this.currency}}</td>
                        <td><span class="status-badge status-{{this.status}}">{{this.status}}</span></td>
                        <td>{{formatDate this.date}}</td>
                        <td>
                            <button class="btn btn-sm btn-edit" onclick="editTransfer({{this.id}})">Editar</button>
                            <button class="btn btn-sm btn-delete" onclick="deleteTransfer({{this.id}})">Eliminar</button>
                        </td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>
        </div>
    </section>
</main>

<!-- Modals -->
<!-- User Modal -->
<div id="userModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="userModalTitle">Agregar Usuario</h3>
            <span class="close" onclick="closeModal('userModal')">&times;</span>
        </div>
        <div class="modal-body">
            <form id="userForm">
                <input type="hidden" id="userId">
                <div class="form-group">
                    <label for="userName">Nombre:</label>
                    <input type="text" id="userName" required>
                </div>
                <div class="form-group">
                    <label for="userEmail">Email:</label>
                    <input type="email" id="userEmail" required>
                </div>
                <div class="form-group">
                    <label for="userPhone">Teléfono:</label>
                    <input type="tel" id="userPhone" required>
                </div>
                <div class="form-group">
                    <label for="userStatus">Estado:</label>
                    <select id="userStatus">
                        <option value="active">Activo</option>
                        <option value="inactive">Inactivo</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('userModal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Account Modal -->
<div id="accountModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="accountModalTitle">Agregar Cuenta</h3>
            <span class="close" onclick="closeModal('accountModal')">&times;</span>
        </div>
        <div class="modal-body">
            <form id="accountForm">
                <input type="hidden" id="accountId">
                <div class="form-group">
                    <label for="accountUserId">Usuario:</label>
                    <select id="accountUserId" required>
                        <option value="">Seleccionar Usuario</option>
                        {{#each data.users}}
                        <option value="{{this.id}}">{{this.name}}</option>
                        {{/each}}
                    </select>
                </div>
                <div class="form-group">
                    <label for="accountNumber">Número de Cuenta:</label>
                    <input type="text" id="accountNumber" required>
                </div>
                <div class="form-group">
                    <label for="accountType">Tipo:</label>
                    <select id="accountType" required>
                        <option value="">Seleccionar Tipo</option>
                        <option value="Cuenta corriente">Cuenta corriente</option>
                        <option value="Cuenta de ahorro">Cuenta de ahorro</option>
                        <option value="Cuenta nómina">Cuenta nómina</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="accountBalance">Balance:</label>
                    <input type="number" id="accountBalance" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="accountCurrency">Moneda:</label>
                    <select id="accountCurrency" required>
                        {{#each data.currencies}}
                        <option value="{{this.symbol}}">{{this.name}} ({{this.symbol}})</option>
                        {{/each}}
                    </select>
                </div>
                <div class="form-group">
                    <label for="accountStatus">Estado:</label>
                    <select id="accountStatus">
                        <option value="active">Activo</option>
                        <option value="inactive">Inactivo</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('accountModal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Card Modal -->
<div id="cardModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="cardModalTitle">Agregar Tarjeta</h3>
            <span class="close" onclick="closeModal('cardModal')">&times;</span>
        </div>
        <div class="modal-body">
            <form id="cardForm">
                <input type="hidden" id="cardId">
                <div class="form-group">
                    <label for="cardUserId">Usuario:</label>
                    <select id="cardUserId" required>
                        <option value="">Seleccionar Usuario</option>
                        {{#each data.users}}
                        <option value="{{this.id}}">{{this.name}}</option>
                        {{/each}}
                    </select>
                </div>
                <div class="form-group">
                    <label for="cardNumber">Número de Tarjeta:</label>
                    <input type="text" id="cardNumber" required>
                </div>
                <div class="form-group">
                    <label for="cardType">Tipo:</label>
                    <select id="cardType" required>
                        <option value="">Seleccionar Tipo</option>
                        <option value="Débito">Débito</option>
                        <option value="Crédito">Crédito</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="cardLimit">Límite:</label>
                    <input type="number" id="cardLimit" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="cardCurrency">Moneda:</label>
                    <select id="cardCurrency" required>
                        {{#each data.currencies}}
                        <option value="{{this.symbol}}">{{this.name}} ({{this.symbol}})</option>
                        {{/each}}
                    </select>
                </div>
                <div class="form-group">
                    <label for="cardStatus">Estado:</label>
                    <select id="cardStatus">
                        <option value="active">Activo</option>
                        <option value="inactive">Inactivo</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('cardModal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Transaction Modal -->
<div id="transactionModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="transactionModalTitle">Agregar Transacción</h3>
            <span class="close" onclick="closeModal('transactionModal')">&times;</span>
        </div>
        <div class="modal-body">
            <form id="transactionForm">
                <input type="hidden" id="transactionId">
                <div class="form-group">
                    <label for="transactionAccountId">Cuenta:</label>
                    <select id="transactionAccountId" required>
                        <option value="">Seleccionar Cuenta</option>
                        {{#each data.accounts}}
                        <option value="{{this.id}}">{{this.accountNumber}} - {{this.type}}</option>
                        {{/each}}
                    </select>
                </div>
                <div class="form-group">
                    <label for="transactionType">Tipo:</label>
                    <select id="transactionType" required>
                        <option value="">Seleccionar Tipo</option>
                        <option value="credit">Crédito (+)</option>
                        <option value="debit">Débito (-)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="transactionDescription">Descripción:</label>
                    <input type="text" id="transactionDescription" required>
                </div>
                <div class="form-group">
                    <label for="transactionAmount">Monto:</label>
                    <input type="number" id="transactionAmount" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="transactionCurrency">Moneda:</label>
                    <select id="transactionCurrency" required>
                        {{#each data.currencies}}
                        <option value="{{this.symbol}}">{{this.name}} ({{this.symbol}})</option>
                        {{/each}}
                    </select>
                </div>
                <div class="form-group">
                    <label for="transactionDate">Fecha:</label>
                    <input type="datetime-local" id="transactionDate" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('transactionModal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Transfer Modal -->
<div id="transferModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="transferModalTitle">Agregar Transferencia</h3>
            <span class="close" onclick="closeModal('transferModal')">&times;</span>
        </div>
        <div class="modal-body">
            <form id="transferForm">
                <input type="hidden" id="transferId">
                <div class="form-group">
                    <label for="transferType">Tipo de Transferencia:</label>
                    <select id="transferType" required>
                        <option value="">Seleccionar Tipo</option>
                        <option value="sent">Enviada</option>
                        <option value="received">Recibida</option>
                        <option value="scheduled">Programada</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="transferFromAccount">Cuenta Origen:</label>
                    <select id="transferFromAccount" required>
                        <option value="">Seleccionar Cuenta</option>
                        {{#each data.accounts}}
                        <option value="{{this.id}}">{{this.accountNumber}} - {{this.type}}</option>
                        {{/each}}
                    </select>
                </div>
                <div class="form-group">
                    <label for="transferRecipientName">Nombre del Beneficiario:</label>
                    <input type="text" id="transferRecipientName" required>
                </div>
                <div class="form-group">
                    <label for="transferRecipientAccount">Cuenta del Beneficiario:</label>
                    <input type="text" id="transferRecipientAccount" required>
                </div>
                <div class="form-group">
                    <label for="transferDescription">Descripción:</label>
                    <input type="text" id="transferDescription" required>
                </div>
                <div class="form-group">
                    <label for="transferAmount">Monto:</label>
                    <input type="number" id="transferAmount" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="transferCurrency">Moneda:</label>
                    <select id="transferCurrency" required>
                        {{#each data.currencies}}
                        <option value="{{this.symbol}}">{{this.name}} ({{this.symbol}})</option>
                        {{/each}}
                    </select>
                </div>
                <div class="form-group">
                    <label for="transferStatus">Estado:</label>
                    <select id="transferStatus" required>
                        <option value="completed">Completada</option>
                        <option value="pending">Pendiente</option>
                        <option value="failed">Fallida</option>
                        <option value="scheduled">Programada</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="transferDate">Fecha:</label>
                    <input type="datetime-local" id="transferDate" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('transferModal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="/js/admin-panel.js"></script>
